-- Display the last occurrence of given char in a string 
SELECT LENGTH('Bhagyashree') - LOCATE('a', REVERSE('Bhagyashree')) + 1 AS LastOccurrenceIndex;
SELECT LEN("Rahul") - CHARINDEX("a", REVERSE("Rahul")) + 1 AS LastOccurrenceIndex;

-- Display all Ename of Emp table in sentence case means 
-- only first char upper case remaining in lower case
SELECT CONCAT(UCASE(LEFT("hello world", 1)), LCASE(SUBSTRING("hello world", 2))) AS EnameInSentenceC
ase;

SELECT CONCAT(UCASE(LEFT(Ename, 1)), LCASE(SUBSTRING(Ename, 2))) AS EnameInSentenceCase
FROM Emp;

-- Take fullName and split into firstName and LastName 
-- Ex 'Ashish Baratam' FirstName Ashish, LastName Baratam
SELECT
    'Rahul Raman' AS FullName,
    SUBSTRING_INDEX('Rahul Raman', ' ', 1) AS FirstName,
    SUBSTRING_INDEX('Rahul Raman', ' ', -1) AS LastName;

-- IN World 'misissipi' count no.of i's
SELECT LENGTH('mississippi') - LENGTH(REPLACE('mississippi', 'i', '')) AS CountOfIs;

-- Add 5 years 10 months and 6 days to the today's date 
SELECT DATE_ADD(DATE_ADD(DATE_ADD(CURDATE(), INTERVAL 5 YEAR), INTERVAL 10 MONTH), INTERVAL 6 DAY) AS NewDate;

-- Display the first day of the next month
SELECT DATE_FORMAT(DATE_ADD(CURDATE(), INTERVAL 1 MONTH), '%Y-%m-01') AS FirstDayOfNextMonth;
SELECT DAYNAME(DATE_ADD(CURDATE(), INTERVAL 1 MONTH)) AS DayOfTheWeekForFirstDayOfNextMonth;

-- Display the last Da of the current Year
SELECT LAST_DAY(CONCAT(YEAR(CURDATE()), '-12-31')) AS LastDayOfCurrentYear;
SELECT DAYNAME(LAST_DAY(CONCAT(YEAR(CURDATE()), '-12-31'))) AS DayOfTheWeekForLastDayOfCurrentYear;

-- Display all friday's of current Month
SELECT COUNT(*) AS NumberOfFridays
FROM (
    SELECT DATE_ADD(LAST_DAY(CURDATE() - INTERVAL 1 MONTH), INTERVAL 1 DAY) AS FirstDay
) AS MonthStart
JOIN (
    SELECT DATE_ADD(FirstDay, INTERVAL (n - 1) WEEK) AS Fridays
    FROM (
        SELECT 1 AS n UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 -- Adjust the number of weeks as needed
    ) AS Numbers
    CROSS JOIN (
        SELECT DATE_ADD(LAST_DAY(CURDATE() - INTERVAL 1 MONTH), INTERVAL 1 DAY) AS FirstDay
    ) AS FirstFriday
    WHERE DAYNAME(DATE_ADD(FirstDay, INTERVAL (n - 1) WEEK)) = 'Friday'
) AS FridayDates;



-- print all fridays of current month
SELECT GROUP_CONCAT(Fridays SEPARATOR ', ') AS AllFridays
FROM (
    SELECT CURDATE() AS CurrentDate
) AS MonthStart
JOIN (
    SELECT
        CURDATE() - INTERVAL (DAY(CURDATE()) - 1) DAY + INTERVAL (n - 1) WEEK AS Fridays
    FROM (
        SELECT 1 AS n UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5-- Adjust the number of weeks as needed
    ) AS Numbers
    WHERE DAYNAME(CURDATE() - INTERVAL (DAY(CURDATE()) - 1) DAY + INTERVAL (n - 1) WEEK) = 'Friday'
) AS FridayDates;
